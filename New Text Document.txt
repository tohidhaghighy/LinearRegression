https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/linear_model/_logistic.py